<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Cryptography: Cracking Codes</title>
  <meta name="description" content="I did the problem below as an optional programming assignment for the course Cryptography on Coursera, offered by the University of Maryland in their Cyberse...">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/coursera/2016/10/10/coursera-cryptography-code-cracking.html">
  <link rel="alternate" type="application/rss+xml" title="Khoa Nguyen&#39;s Personal Website" href="/feed.xml">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  
  
</head>

<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">

    <a class="site-title" href="/">Khoa Nguyen&#39;s Personal Website</a>

    <nav class="site-nav">
      <span class="menu-icon">
        <svg viewBox="0 0 18 15" width="18px" height="15px">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </span>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Cryptography: Cracking Codes</h1>
  </header>

  <div class="post-content">
    

<!-- <h1 class="title">Cryptography: Cracking Codes</h1> -->

<span style="color:##85929E;">
    <time datetime="10-10-2016">Monday. October 10, 2016</time>
     - <span class="reading-time" title="Estimated read time">
    

    
        14 mins
    
</span>

</span>


    <div class="post-tags">
        
    </div>


<p>I did the problem below as an optional programming assignment for the course Cryptography on Coursera, offered by the University of Maryland in their Cybersecurity Specialization.</p>

<h4 id="problem-statement">Problem Statement:</h4>
<p><em>Numbered below are 7 ciphertexts, each of which was generated by encrypting some 31-character ASCII plaintext with the one-time pad using the same key (code for the encryption program used is given below). Decrypt them and recover all 7 plaintexts, each of which is a grammatically correct English sentence. Note: for this problem it is easiest to use a combination of automated analysis plus human insight and even occasional guessing. As long as you can decrypt them all, it doesn’t matter how you do it.</em></p>

<p><code class="highlighter-rouge">1. BB 3A 65 F6 F0 03 4F A9 57 F6 A7 67 69 9C E7 FA BA 85 5A FB 4F 2B 52 0A EA D6 12 94 4A 80 1E</code></p>

<p><code class="highlighter-rouge">2. BA 7F 24 F2 A3 53 57 A0 5C B8 A1 67 62 C5 A6 AA AC 92 4A E6 44 7F 06 08 A3 D1 13 88 56 9A 1E</code></p>

<p><code class="highlighter-rouge">3. A6 72 61 BB B3 06 51 BA 5C F6 BA 29 7E D0 E7 B4 E9 89 4A A9 5E 30 02 47 F0 C0 02 8F 40 9A 1E</code></p>

<p><code class="highlighter-rouge">4. A5 72 61 F5 F0 00 4B A7 4C F4 AA 29 79 D9 A6 B7 AC 85 4D A9 5E 30 52 03 EC 85 15 95 4C 9D 0F</code></p>

<p><code class="highlighter-rouge">5. BB 3A 70 F3 B9 1D 48 E8 4D F0 AB 70 2E CF EE B5 BC 8C 5D A9 4C 30 1E 0B EC D2 41 95 4C 83 1E</code></p>

<p><code class="highlighter-rouge">6. A6 72 6D E8 F0 1A 50 E8 49 ED BC 6C 7C 9C F2 B2 A8 8E 19 FD 42 3E 06 47 EC CB 04 DD 4C 9D 1E</code></p>

<p><code class="highlighter-rouge">7. BC 75 70 BB BF 1D 46 E8 5A F9 AA 6C 7A 9C EF A9 E9 82 5C FD 5E 3A 00 47 F7 CD 00 93 05 A7 1E</code></p>

<p><em>Here is the code of the encryption program:</em></p>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="cp">#include 
#define KEY_LENGTH 31
</span> 
<span class="n">main</span><span class="p">(){</span>
  <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>
  <span class="kt">FILE</span> <span class="o">*</span><span class="n">fpIn</span><span class="p">,</span> <span class="o">*</span><span class="n">fpOut</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="n">KEY_LENGTH</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
  <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">};</span>
  <span class="c1">// Of course, I did not use the all-0 key when generating the 7 ciphertexts above!
</span> 
  <span class="n">fpIn</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"messages.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
  <span class="n">fpOut</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"ctexts.txt"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">);</span>
 
  <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
 
  <span class="k">while</span> <span class="p">(</span><span class="n">fscanf</span><span class="p">(</span><span class="n">fpIn</span><span class="p">,</span> <span class="s">"%c"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ch</span><span class="p">)</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">fpOut</span><span class="p">,</span> <span class="s">"%02X"</span><span class="p">,</span> <span class="n">ch</span><span class="o">^</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="n">i</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">31</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">fpOut</span><span class="p">,</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
      <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
      <span class="n">fscanf</span><span class="p">(</span><span class="n">fpIn</span><span class="p">,</span> <span class="s">"%c"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ch</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
 
  <span class="n">fclose</span><span class="p">(</span><span class="n">fpIn</span><span class="p">);</span>
  <span class="n">fclose</span><span class="p">(</span><span class="n">fpOut</span><span class="p">);</span>
 
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<h4 id="my-solution">My Solution:</h4>

<p>This problem gave me unusual excitement, because quite honestly I really enjoy cracking codes. It’s like you’re in a detective movie :)</p>

<p>After reading the encryption code (it basically XORed each character of the key with the corresponding character of the plaintexts), I decided to look over the ciphertexts to see if there was any pattern a human could recognize. It was pretty easy to see that the last character of 6 out of 7 ciphertexts was all <code class="highlighter-rouge">0x1E</code> except for (4) with <code class="highlighter-rouge">0x0F</code>. Because they were all grammatically correct English sentences, I guessed that <code class="highlighter-rouge">0x1E</code> stood for the period (.) and <code class="highlighter-rouge">0x0F</code> stood for the question mark (?). And so I broke the last byte of the key, which was <code class="highlighter-rouge">0x30</code>.</p>

<p>Now… I was stuck.</p>

<p>The rest of the ciphertexts made little sense. For a while I tried (stupidly) to find other patterns, but there were none. Then I suddenly realized that because they all used the same 31-byte key, and they were all English sentences, the characters must be either space (ASCII decimal #32), or uppercase letters (ASCII decimal #65-90), or lowercase letters (ASCII decimal #97-122). I excluded punctuations to prevent diluting the results, since most of the characters in the sentences would be English letters and spaces anyway. If I could figure out enough letters, I could use them to infer what the others were.</p>

<p>So I wrote a little code in C++ that tried every possible character from <code class="highlighter-rouge">0x00</code> to <code class="highlighter-rouge">0xFF</code> as key to XOR against each character of the 7 ciphertexts to see which one resulted in the desired ASCII ranges above, then output that key character and the corresponding decrypted characters. Below is an example screenshot of the raw output (this means for the 4th character of every ciphertext, the only key that works is <code class="highlighter-rouge">0x9b</code> which produces letter <code class="highlighter-rouge">m</code> for ciphertext (1), letter <code class="highlighter-rouge">i</code> for ciphertext (2), and so forth at that position. For the 7th character, there are many possibilities):</p>

<p><img src="http://localhost:4000\assets\images\20161010cracking1.png" alt="alt text" /></p>

<p>…and partial &amp; complete outputs (after I did some manual fill-in-the-blanks):</p>

<p><img src="http://localhost:4000\assets\images\20161010cracking2.png" alt="alt text" /></p>

<p>So there it was! The key in hexadecimal is:</p>

<p><code class="highlighter-rouge">key[31] = {0xf2, 0x1a, 0x04, 0x9b, 0xd0, 0x73, 0x23, 0xc8, 0x39, 0x98, 0xce, 0x09, 0x0e, 0xbc, 0x86, 0xda, 0xc9, 0xe0, 0x39, 0x89, 0x2a, 0x5f, 0x72, 0x67, 0x83, 0xa5, 0x61, 0xfd, 0x25, 0xee, 0x30};</code></p>

<p>You can find the code I wrote below:</p>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="cp">#include &lt;iostream&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
 
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
<span class="c1">// ciphertexts
</span>    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ciphertext</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="p">{</span><span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">},</span>
 
<span class="p">{</span><span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span><span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">},</span>
 
<span class="p">{</span><span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">},</span>
 
<span class="p">{</span><span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">},</span>
 
<span class="p">{</span><span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">},</span>
 
<span class="p">{</span><span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">},</span>
 
<span class="p">{</span><span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">}</span>
    <span class="p">};</span>
 
<span class="c1">// This outputs all possible candidates for each character of each ciphertext
</span>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"------------ Raw result: --------"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">plaintext</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">31</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">31</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">dec</span> <span class="o">&lt;&lt;</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="s">"---</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">bool</span> <span class="n">flag</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">// If the result is not in the desired ASCII range, break and move on to next key
</span>                <span class="kt">int</span> <span class="n">check</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">ciphertext</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">^</span> <span class="n">k</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">check</span> <span class="o">&lt;</span> <span class="mi">65</span> <span class="o">&amp;&amp;</span> <span class="n">check</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">||</span>
                     <span class="p">(</span><span class="n">check</span> <span class="o">&gt;</span> <span class="mi">90</span> <span class="o">&amp;&amp;</span> <span class="n">check</span> <span class="o">&lt;</span> <span class="mi">97</span><span class="p">)</span> <span class="o">||</span>
                     <span class="p">(</span><span class="n">check</span> <span class="o">&gt;</span> <span class="mi">122</span><span class="p">))</span> <span class="p">{</span>
                        <span class="n">flag</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
                        <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
 
<span class="c1">// If this key produces a match, output the results (maybe wrong)
</span>            <span class="k">if</span> <span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">hex</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s">": "</span><span class="p">;</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="s">"."</span> <span class="o">&lt;&lt;</span>
                        <span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span> <span class="n">ciphertext</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">^</span> <span class="n">k</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span><span class="p">;</span>
                    <span class="n">plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span> <span class="n">ciphertext</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">^</span> <span class="n">k</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
                <span class="n">count</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="c1">// If there are more than one possibility, set that character of
// plaintext to (_) to denote unfilled blanks
</span>        <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'_'</span><span class="p">;</span>
            <span class="p">}</span>
         <span class="p">}</span>
    <span class="p">}</span>
 
<span class="c1">// Print out the partial results with some blanks unfilled in the plaintexts
</span>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"----------- Partial result: -----"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="s">". "</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">31</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s"> </span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    <span class="p">}</span>
 
<span class="c1">// This key is what I got after doing some manual fill-in-the-blanks
</span>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"----------- Full result: --------"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x9b</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span>
<span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xce</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0xda</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0xe0</span><span class="p">,</span>
<span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x2a</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span>
<span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">};</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="s">". "</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">31</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span> <span class="n">ciphertext</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>  
 
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>



<!--  -->


    <div class="related">
    
    
        
        
    
        
        
    
        
        
    
    
</div>




    <section class="author">
    <!-- <div class="toleft"> -->
    <!--     <img class="selfie" src="http://localhost:4000/" alt=""> -->
    <!-- </div> -->

    <div class="toright">
        <!-- <h4 class="name"></h4> -->
        <!-- <p class="bio"></p> -->

        <div class="share">
		  <!-- The below adds SHARE buttons to the blog posts -->
          <!-- Note: Only use 3 share links if your site width is set to large -->
          <!-- If site width is set to normal, you may choose any 2 share links -->

          <a class="twitter" href="https://twitter.com/intent/tweet?text=http://localhost:4000/coursera/2016/10/10/coursera-cryptography-code-cracking.html - Cryptography: Cracking Codes by @nguyen_khoa18">
            <i class="fa fa-twitter-square" aria-hidden="true"></i>  Tweet  |
            </a>

            <a class="facebook" href="javascript:void(0)" onclick="window.open('https://facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href), 'facebook-share-dialog', 'width=626,height=436'); return false;">
                <i class="fa fa-facebook-square" aria-hidden="true"></i>  Share  |  
            </a>

			<a class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://localhost:4000/coursera/2016/10/10/coursera-cryptography-code-cracking.html&amp;title=Cryptography: Cracking Codes&amp;summary=&amp;source=http://localhost:4000" target="_blank">
			  <i class="fa fa-linkedin-square" aria-hidden="true"></i>  Share  
             </a>
			
            <!-- <a class="google-plus" href="https://plus.google.com/share?url=http://localhost:4000/coursera/2016/10/10/coursera-cryptography-code-cracking.html" target="_blank">
                <svg class="icon icon-google-plus"><use xlink:href="#icon-google-plus"></use></svg><span class="icon-google-plus">Share</span>
            </a> -->


            <!-- <a class="reddit" href="https://reddit.com/submit?url=http://localhost:4000/coursera/2016/10/10/coursera-cryptography-code-cracking.html&amp;title=Cryptography: Cracking Codes" target="_blank">
                <svg class="icon icon-reddit"><use xlink:href="#icon-reddit"></use></svg><span class="icon-reddit">Share</span>
            </a> -->
        </div>
    </div>
</section>





  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Khoa Nguyen&#39;s Personal Website</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              Khoa Nguyen
            
            </li>
            
            <li><a href="mailto:knguyen18@wooster.edu">knguyen18@wooster.edu</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
			<a href="https://github.com/nguyen_khoa18">
			  <i class="fa fa-twitter-square" aria-hidden="true"></i>  nguyen_khoa18
			</a>
            <!-- <a href="https://twitter.com/"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username"></span></a>
 -->
          </li>
          

          
          <li>
			<a href="https://github.com/">
			  <i class="fa fa-github-square" aria-hidden="true"></i>  nguyen-khoa
			</a>

          </li>
          

		  
		  <li>
			<a href="https://linkedin.com/in/">
			  <i class="fa fa-linkedin-square" aria-hidden="true"></i>  nguyen-khoa
			</a>
		  </li>
		  
		  
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>I&#39;m a tech nerd, and I&#39;m proud of it.</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
